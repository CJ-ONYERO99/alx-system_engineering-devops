#!/usr/bin/env bash
# A redirection script.
# Install Nginx
sudo apt-get update
sudo apt-get -y install nginx

# Configure the Uncomplicated Firewall (UFW) to allow incoming traffic for the Nginx HTTP service
sudo ufw allow 'Nginx HTTP'

# Define the redirect URL
REDIRECT_URL='https://github.com/CJ-ONYERO99'

# Replace the existing server block in the Nginx configuration file with a new one that includes the redirection
sudo sed -i '/server {/,/}/{ /server {/{p; s/}/{\n    location /redirect_me {\n        return 301 '$REDIRECT_URL';\n    }/\n}/; d; }' /etc/nginx/sites-available/default

# Reload Nginx configuration
sudo service nginx reload
sudo service nginx restart

echo "Redirection configured for /redirect_me to $REDIRECT_URL"

# Verify redirection
sudo curl -sI localhost/redirect_me/ && echo
