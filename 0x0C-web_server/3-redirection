#!/usr/bin/env bash
# Update package lists
apt update

# Install Nginx web server
apt install -y nginx

# Redirect location configuration
TARGET_LOCATION="/var/www/html/redirect_me"
REDIRECT_URL="https://github.com/CJ-ONYERO99?tab=repositories"

# Ensure target location directory exists
mkdir -p "$TARGET_LOCATION"

# Create an empty index.html file (optional, can be left empty)
touch "$TARGET_LOCATION/index.html"

# Backup the original Nginx configuration (optional)
cp /etc/nginx/nginx.conf /etc/nginx/nginx.conf.bak

# Use sed to modify server block configuration for redirection
sed -i "/server {/a \
    location /redirect_me { \
        return 301 $REDIRECT_URL; \
    } \
" /etc/nginx/nginx.conf

# Reload Nginx configuration
service nginx reload

# Test the redirection with curl
curl -sI http://localhost/redirect_me/

echo "Redirection configured for /redirect_me to $REDIRECT_URL"
