#!/usr/bin/env bash
# Script to configure Nginx for redirection.

# Updating Packages before making Installations
sudo apt-get update

# Install Nginx
sudo apt-get -y install nginx

# Configuring the Uncomplicated Firewall (UFW) to allow incoming traffic for the Nginx HTTP service
sudo ufw allow 'Nginx HTTP'

# Define the redirect URL
REDIRECT_URL='https://github.com/CJ-ONYERO99'

# Backup the original configuration (optional)
sudo cp /etc/nginx/sites-available/default /etc/nginx/sites-available/default.bak

# Add new redirection block (using sed)
sudo sed -r -i '|^location \/ {|a \
    location /redirect_me {
      return 301 '$REDIRECT_URL';
    }' /etc/nginx/sites-available/default

# Reload Nginx configuration
sudo service nginx reload
sudo service nginx restart

echo "Redirection configured for /redirect_me to $REDIRECT_URL"

# Verify redirection
sudo curl -sI localhost/redirect_me/ && echo
