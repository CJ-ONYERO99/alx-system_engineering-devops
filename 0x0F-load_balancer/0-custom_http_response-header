#!/usr/bin/env bash

# Update Nginx and its dependencies
sudo apt-get update nginx
sudo apt-get install -y nginx

# Add custom response header (X-Served-By)
# This line adds the header "X-Served-By" with the server's hostname value
# after the line containing "server_name _;" in the default Nginx configuration file
sudo sed -i "/server_name _/a add_header X-Served-By $HOSTNAME;" /etc/nginx/sites-enabled/default

# Test Nginx configuration for errors
# This checks for syntax errors in the Nginx configuration before restarting
sudo nginx -t

# Restart Nginx service
# This restarts the Nginx service to apply the configuration changes
sudo systemctl restart nginx
